<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Growing Path">
<meta property="og:type" content="website">
<meta property="og:title" content="Joyce&#39; Blog">
<meta property="og:url" content="http://yoursite.com/page/26/index.html">
<meta property="og:site_name" content="Joyce&#39; Blog">
<meta property="og:description" content="Growing Path">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Joyce&#39; Blog">
<meta name="twitter:description" content="Growing Path">

<link rel="canonical" href="http://yoursite.com/page/26/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Joyce' Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Joyce' Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/数据库大作业笔记（八）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/14/数据库大作业笔记（八）/" class="post-title-link" itemprop="url">数据库大作业笔记（八）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2019-05-14 20:13:13 / 修改时间：20:13:14" itemprop="dateCreated datePublished" datetime="2019-05-14T20:13:13+08:00">2019-05-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="PHP与数据库中的查询"><a href="#PHP与数据库中的查询" class="headerlink" title="PHP与数据库中的查询"></a>PHP与数据库中的查询</h4><h5 id="查询构造器"><a href="#查询构造器" class="headerlink" title="查询构造器"></a>查询构造器</h5><p>典型用法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$rows = (<span class="keyword">new</span> \yii\db\Query())</span><br><span class="line">    -&gt;select([<span class="string">'id'</span>, <span class="string">'email'</span>])</span><br><span class="line">    -&gt;from(<span class="string">'user'</span>)</span><br><span class="line">    -&gt;where([<span class="string">'last_name'</span> =&gt; <span class="string">'Smith'</span>])</span><br><span class="line">    -&gt;limit(<span class="number">10</span>)</span><br><span class="line">    -&gt;all();</span><br></pre></td></tr></table></figure>
<p>上面的代码将会生成并执行如下的SQL语句，其中 <code>:last_name</code> 参数绑定了 字符串 <code>&#39;Smith&#39;</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">`id`</span>, <span class="string">`email`</span> </span><br><span class="line"><span class="keyword">FROM</span> <span class="string">`user`</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="string">`last_name`</span> = :last_name</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h5 id="创建查询"><a href="#创建查询" class="headerlink" title="创建查询"></a>创建查询</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$query-&gt;select([<span class="string">'user.id AS user_id'</span>, <span class="string">'email'</span>]);</span><br><span class="line"><span class="comment">// 等同于：</span></span><br><span class="line">$query-&gt;select([<span class="string">'user_id'</span> =&gt; <span class="string">'user.id'</span>, <span class="string">'email'</span>]);</span><br><span class="line"><span class="comment">// 等同于：</span></span><br><span class="line">$query-&gt;select(<span class="string">'user.id AS user_id, email'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT * FROM `user`</span></span><br><span class="line">$query-&gt;from(<span class="string">'user'</span>);</span><br></pre></td></tr></table></figure>
<p>SQL 语句当中的 <code>WHERE</code> 子句：</p>
<ul>
<li>字符串格式，例如：<code>&#39;status=1&#39;</code></li>
<li>哈希格式，例如： <code>[&#39;status&#39; =&gt; 1, &#39;type&#39; =&gt; 2]</code></li>
<li>操作符格式，例如：<code>[&#39;like&#39;, &#39;name&#39;, &#39;test&#39;]</code></li>
<li>对象格式，例如：<code>new LikeCondition(&#39;name&#39;, &#39;LIKE&#39;, &#39;test&#39;)</code></li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$query-&gt;where(<span class="string">'status=1'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或使用参数绑定来绑定动态参数值</span></span><br><span class="line">$query-&gt;where(<span class="string">'status=:status'</span>, [<span class="string">':status'</span> =&gt; $status]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原生 SQL 在日期字段上使用 MySQL YEAR() 函数</span></span><br><span class="line">$query-&gt;where(<span class="string">'YEAR(somedate) = 2015'</span>);</span><br></pre></td></tr></table></figure>
<p>千万不要像如下的例子一样直接在条件语句当中嵌入变量，特别是当这些变量来源于终端用户输入的时候， 因为这样我们的软件将很容易受到 SQL 注入的攻击。(嘘~我的代码里就这样写过，悄咪咪的)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 危险！千万别这样干，除非你非常的确定 $status 是一个整型数值。</span></span><br><span class="line">$query-&gt;where(<span class="string">"status=$status"</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$status = <span class="number">10</span>;</span><br><span class="line">$search = <span class="string">'yii'</span>;</span><br><span class="line"></span><br><span class="line">$query-&gt;where([<span class="string">'status'</span> =&gt; $status]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>($search)) &#123;</span><br><span class="line">    $query-&gt;andWhere([<span class="string">'like'</span>, <span class="string">'title'</span>, $search]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果 $search 不为空，那么将会生成如下 SQL 语句：</span></span><br><span class="line">... WHERE (`status` = <span class="number">10</span>) <span class="keyword">AND</span> (`title` LIKE <span class="string">'%yii%'</span>)</span><br></pre></td></tr></table></figure>
<p>这次作业中的查询主要用了like操作符：</p>
<p><strong>like</strong>：第一个操作数应为一个字段名称或 DB 表达式， 第二个操作数可以使字符串或数组， 代表第一个操作数需要模糊查询的值。比如，[‘like’, ‘name’, ‘tester’] 会生成 name LIKE ‘%tester%’。 如果范围值是一个数组，那么将会生成用 AND 串联起来的 多个 like 语句。例如，[‘like’, ‘name’, [‘test’, ‘sample’]] 将会生成 name LIKE ‘%test%’ AND name LIKE ‘%sample%’</p>
<h5 id="过滤条件"><a href="#过滤条件" class="headerlink" title="过滤条件"></a>过滤条件</h5><p>filterWhere()用于通常需要忽略用户输入的空值。</p>
<p>andfilterWhere()类似于andWhere()</p>
<p>使用yii\helpers\Html::submitButton() 方法生成提交按钮</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/2018_06_summary/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/14/2018_06_summary/" class="post-title-link" itemprop="url">2018_06作文与翻译总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-14 10:33:39" itemprop="dateCreated datePublished" datetime="2019-05-14T10:33:39+08:00">2019-05-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>2018年6月三套六级题目的作文与翻译已经学习完了，今天再粗略地过一遍短语和句型，做下笔记方便以后查找。</p>
<ol>
<li>成为不可或缺的一部分 <strong>become an integral part of</strong> </li>
<li>开车上下班 <strong>drive to and from work</strong></li>
<li>交通拥堵和停车位不足的问题日益严峻 <strong>more prevalent traffic gridlock and inadequate parking space</strong></li>
<li>出台新规 <strong>roll out new rules</strong> </li>
<li>限制 <strong>rein in</strong></li>
<li>新能源汽车 <strong>new energy vehicles</strong></li>
<li>采取一些措施，支持… <strong>take some measure to support</strong></li>
<li>促使…做… <strong>prompted … to …</strong> /  <strong>drive … to…</strong></li>
</ol>
<p><strong>It is an undeniable fact that …</strong></p>
<p><strong>lay a solid foundation for </strong></p>
<p><strong>commercial activities</strong></p>
<p><strong>plays a crucial role</strong> in <strong>boosting an organization</strong></p>
<p><strong>To begin with</strong></p>
<p><strong>have passion for work</strong></p>
<p><strong>achieve mutual consensus</strong>, <strong>build harmonious cooperation and have effective communication</strong></p>
<p><strong>is beneficial to</strong></p>
<p><strong>create a pleasant working atmosphere</strong></p>
<p><strong>not surprisingly</strong></p>
<p><strong>spur continuous development</strong> of the individuals</p>
<p><strong>Taking into account</strong></p>
<p><strong>arrive at a conclusion</strong> that it is <strong>sensible</strong> for</p>
<p><strong>keep in mind</strong></p>
<p><strong>a win-win situation</strong></p>
<ol>
<li>最大最快的高速铁路网 <strong>the largest and fastest high-speed rail network</strong></li>
<li>高铁 <strong>the CRH</strong>(China Railway High-Speed) train</li>
<li>高铁站 <strong>high-speed rail station</strong></li>
<li>高铁列车的突出优势在于准时 the <strong>outstanding advantage</strong> of the CRH train is <strong>punctuality</strong></li>
<li>基本不受天气的影响 is <strong>basically not affected by</strong> weather</li>
<li>乘高铁上下班 <strong>commute by CRH train</strong> </li>
</ol>
<p><strong>have a major influence on a kid’s development</strong></p>
<p>is <strong>crucial and indispensable</strong> in <strong>maintaining the relationship</strong></p>
<p><strong>only when</strong> a student … <strong>is he or she willing to</strong> </p>
<p><strong>look to the teacher for guidance and support</strong></p>
<p><strong>are weary of</strong></p>
<p><strong>drop out of school</strong></p>
<p><strong>transform their whole life</strong></p>
<p><strong>has the full trust of</strong> sb.</p>
<p>is  <strong>motivated</strong> to </p>
<p><strong>consciousness and initiative</strong> of learning</p>
<p>The <strong>credibility</strong> between teachers and students <strong>is not something that can built in a day</strong></p>
<p><strong>comprehend the students’ actual demands and offer timely help</strong></p>
<p><strong>be respectful to</strong></p>
<p>is <strong>a must</strong></p>
<ol>
<li>最主要的交通工具 the leading means of transportation</li>
<li>中国城乡 China’s cities and villages</li>
<li>一度被称为“自行车王国”  was once called “the Kingdom of Bicycles”</li>
<li>随着城市交通拥堵和空气污染日益严重 with traffic congestion and air pollution becoming more and more serious</li>
<li>中国企业家 China’s entrepreneurs</li>
<li>共享单车（shared bikes）的商业模式 business model of bike-sharing</li>
<li>出行 get around</li>
<li>自行车道 bike lanes</li>
</ol>
<p>Today, <strong>in the context of</strong> this era <strong>featured by</strong> increasing <strong>commercialization and digitalization</strong>,</p>
<p><strong>mutually-trusted relations</strong></p>
<p><strong>particularly</strong> important</p>
<p><strong>take a leading role</strong> in</p>
<p><strong>be honest with</strong></p>
<p><strong>has a dishonest attitude toward</strong></p>
<p><strong>lack purchasing confidence in</strong></p>
<p><strong>bring huge economic loss to</strong> the business</p>
<p><strong>side effect</strong></p>
<p>The <strong>collapse</strong> of Sanlu <strong>Mike Power Company</strong></p>
<p>a <strong>testament</strong> to</p>
<p>the <strong>incident</strong> of <strong>poisonous</strong> milk</p>
<p><strong>exerted devasting consequences on</strong></p>
<p>the <strong>proliferation</strong> of <strong>counterfeit goods</strong></p>
<p><strong>lose confidence in</strong> <strong>domestic products</strong></p>
<p><strong>have no alternative but to</strong></p>
<p><strong>resort to foreign brands</strong></p>
<p><strong>it is high time</strong> for us to <strong>strengthen</strong>…</p>
<p><strong>promote</strong> the healthy development of …</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/数据库大作业笔记（七）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/13/数据库大作业笔记（七）/" class="post-title-link" itemprop="url">数据库大作业笔记（七）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-13 20:57:19" itemprop="dateCreated datePublished" datetime="2019-05-13T20:57:19+08:00">2019-05-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-05-14 10:03:47" itemprop="dateModified" datetime="2019-05-14T10:03:47+08:00">2019-05-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>####事务</p>
<p>作业要求写含事务应用的删除操作，这描述，总觉得不是很清晰，是在PHP里写事务还是在MySQL里写呢？最开始考虑到MySQL没法存事务，所以我是改写了delete()函数，代码如下：</p>
<p>Path:common\models\Borrow.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">delete</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       $db = Yii::$app-&gt;db;</span><br><span class="line">       $transaction = $db-&gt;beginTransaction();</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           $result = <span class="keyword">$this</span>-&gt;deleteInternal();</span><br><span class="line">           <span class="keyword">if</span> ($result === <span class="keyword">false</span>) &#123;</span><br><span class="line">               $db-&gt;createCommand(<span class="string">'INSERT INTO audit_borrow VALUES(user(),now(),0)'</span>)-&gt;execute();</span><br><span class="line">               $transaction-&gt;rollBack();</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               $db-&gt;createCommand(<span class="string">'INSERT INTO audit_borrow VALUES(user(),now(),1)'</span>)-&gt;execute();</span><br><span class="line">               $transaction-&gt;commit();</span><br><span class="line">           &#125;</span><br><span class="line">           &#125; <span class="keyword">catch</span>(\<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">               $transaction-&gt;rollBack();</span><br><span class="line">               <span class="keyword">throw</span> $e;</span><br><span class="line">           &#125; <span class="keyword">catch</span>(\Throwable $e) &#123;</span><br><span class="line">               $transaction-&gt;rollBack();</span><br><span class="line">               <span class="keyword">throw</span> $e;</span><br><span class="line">           &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>后来想到可以在存储过程里写事务，这样的话应该会更符合要求吧。在这之前还是要先学一下事务的写法：</p>
<ul>
<li>在 MySQL 中只有使用了 Innodb 数据库引擎的数据库或表才支持事务。</li>
<li>事务处理可以用来维护数据库的完整性，保证成批的 SQL 语句要么全部执行，要么全部不执行。</li>
<li>事务用来管理 insert,update,delete 语句</li>
</ul>
<p>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE DEFINER=`root`@`localhost` PROCEDURE `proc_delete`(IN `newborwid` CHAR(2), IN `username` CHAR(20))</span><br><span class="line">    DETERMINISTIC</span><br><span class="line">BEGIN</span><br><span class="line">DECLARE t_error INTEGER;</span><br><span class="line">DECLARE    CONTINUE HANDLER FOR SQLEXCEPTION SET t_error = 1;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">-- 由于有外键约束，要注意下面两句的先后顺序！</span><br><span class="line">INSERT INTO audit_borrow VALUES(username,now(),newborwid);</span><br><span class="line">DELETE FROM borrow where borwid=newborwid;</span><br><span class="line">IF t_error = 1 THEN</span><br><span class="line">ROLLBACK;</span><br><span class="line">ELSE</span><br><span class="line">COMMIT;</span><br><span class="line">END IF;</span><br><span class="line">select newborwid;</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>我们建立的数据库一般都是 InnoDB 数据库，其上建立的表是事务性表，也就是事务安全的。这时，若SQL语句或触发器执行失败，MySQL 会回滚事务，有：</p>
<p>①如果 BEFORE 触发器执行失败，SQL 无法正确执行②SQL 执行失败时，AFTER 型触发器不会触发③AFTER 类型的触发器执行失败，SQL 会回滚。</p>
<h4 id="declare-handler声明异常处理"><a href="#declare-handler声明异常处理" class="headerlink" title="declare handler声明异常处理"></a>declare handler声明异常处理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DECLARE</span><br><span class="line">-- 处理类型 继续或退出</span><br><span class="line">&#123;EXIT | CONTINUE&#125; </span><br><span class="line">HANDLER FOR</span><br><span class="line">-- 触发条件</span><br><span class="line">&#123;error-number | SQLSTATE error-string | condition&#125;</span><br><span class="line">-- 错误触发的操作</span><br><span class="line">SQL statement</span><br><span class="line"></span><br><span class="line">-- example:</span><br><span class="line">declare continue handler for SQLEXCEPTION set L_error=1;</span><br></pre></td></tr></table></figure>
<p>发生错误的条件有：</p>
<p>1、MYSQL错误代码</p>
<p>2、ANSI-standard SQLSTATE code</p>
<p>3、命名条件。可使用系统内置的SQLEXCEPTION,SQLWARNING和NOT FOUND</p>
<p>参考<a href="https://www.cnblogs.com/datoubaba/archive/2012/06/20/2556428.html" target="_blank" rel="noopener">文章</a></p>
<p>嗯，好了，外键约束真是令人头大。最开始因为在audit_borrow和audit_equipment上加了外键约束，导致borrow和equipment, category的删除插入总是出问题。现在，重新写事务：（因为要涉及多张表，上面那个不符合要求）</p>
<p>Path:backend\controllers\CategoryController.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionDelete</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    $username=Yii::$app-&gt;user-&gt;identity-&gt;username;</span><br><span class="line">    $model = <span class="keyword">$this</span>-&gt;findModel($id);</span><br><span class="line">    <span class="keyword">if</span> (!$model-&gt;load(Yii::$app-&gt;request-&gt;post())) &#123;</span><br><span class="line"></span><br><span class="line">        $command= Yii::$app-&gt;db</span><br><span class="line">            -&gt;createCommand(<span class="string">'call proc_delete(:p0,:p1)'</span>)</span><br><span class="line">            -&gt;bindValues([<span class="string">":p0"</span> =&gt;$model-&gt;catid,<span class="string">":p1"</span>=&gt;$username]);</span><br><span class="line">        $res=$command-&gt;execute();</span><br><span class="line">        <span class="keyword">if</span>($res&gt;=<span class="number">0</span>)</span><br><span class="line">        &#123;             </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redirect([<span class="string">'index'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redirect([<span class="string">'index'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>数据库存储过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE DEFINER=`root`@`localhost` PROCEDURE `proc_delete`(IN `newcatid` CHAR(2), IN `username` CHAR(20))</span><br><span class="line">    DETERMINISTIC</span><br><span class="line">BEGIN</span><br><span class="line">DECLARE t_error INTEGER;</span><br><span class="line">DECLARE    CONTINUE HANDLER FOR SQLEXCEPTION SET t_error = 1;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">INSERT INTO audit_category VALUES(username,now(),newcatid);</span><br><span class="line">DELETE FROM borrow where eqpid IN(</span><br><span class="line">SELECT eqpid from equipment where equipment.catid=newcatid</span><br><span class="line">);</span><br><span class="line">DELETE FROM equipment where catid=newcatid;</span><br><span class="line">DELETE FROM category where catid=newcatid;</span><br><span class="line">IF t_error = 1 THEN</span><br><span class="line">ROLLBACK;</span><br><span class="line">ELSE</span><br><span class="line">COMMIT;</span><br><span class="line">END IF;</span><br><span class="line">select newcatid;</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<font color="blue">注意写分号！！！</font>

<h4 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONCAT(new.catid,&quot;000&quot;)</span><br></pre></td></tr></table></figure>
<p>注：如果if条件为NULL的话，会走else if语句</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/算法大作业笔记（一）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/13/算法大作业笔记（一）/" class="post-title-link" itemprop="url">算法大作业笔记（一）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-13 14:34:04" itemprop="dateCreated datePublished" datetime="2019-05-13T14:34:04+08:00">2019-05-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-05-14 23:00:27" itemprop="dateModified" datetime="2019-05-14T23:00:27+08:00">2019-05-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h4><font color="red">参考网上代码，自己和自己之间为0，不算相连，需要修改—&gt;主要原因是有这一句：if (edges[i][j] &amp;&amp; vertexes[j].color == nowcol)</font>

<p>结构体：关于边的信息，保存在bool型的二维数组里；只定义顶点结构。顶点的信息有：行、列、颜色；行和列换成序号吧，更普遍一些。自己到自己，算相连吗……先，算上，不行再改。</p>
<p>目前connectSudo()已经能正确地返回Sudo的顶点连接信息了。接下来，开始读取顶点的信息吧。嗯，现在getVertex(int n, int m)可以读取需要预着色的点了，无颜色的点色号为-1，返回顶点的数组。getEdges(int n,int x)读取边的信息，有n个顶点x条边，注意输入的是x条边，但矩阵应是对称矩阵，有2x个位置要改变。返回bool型二维数组。接下来，需要准备一些图形的数据了。输入顶点数n，预着色点数m，边数x，颜色总数colornum，两个文件存放数据：</p>
<ol>
<li>顶点的信息：m行，每行有两个整数，分别是顶点编号和颜色</li>
<li>边的信息：x行，每一行分别是两个点的序号，表示这两点相连</li>
</ol>
<h4 id="算法设计"><a href="#算法设计" class="headerlink" title="算法设计"></a>算法设计</h4><h5 id="贪心算法"><a href="#贪心算法" class="headerlink" title="贪心算法"></a>贪心算法</h5><p>贪心原则：把一个颜色用到不再能用了为止。</p>
<p>扫描所有未着色的顶点集，对其中的每个顶点，确定是否与已着新颜色的任何顶点都不相邻。若不相邻，则着色。</p>
<font color="red">WelchPowell文件里的代码为什么在着色之前要将顶点按照度数递减的次序排序呢？</font>

<p>目前代码对graph1中的数据进行了测试，无误。graph1中存的是17条边的信息。主要代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printVertex</span><span class="params">(vertex* ver,<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; ver[i].index &lt;&lt; <span class="string">" "</span> &lt;&lt; ver[i].color &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造顶点信息,预着色</span></span><br><span class="line"><span class="function">vertex* <span class="title">getVertexes</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vertex* vertexes = <span class="keyword">new</span> vertex[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">	&#123;<span class="comment">//n为顶点个数，m为已着色的顶点数</span></span><br><span class="line">		vertexes[i].index = i;</span><br><span class="line">		vertexes[i].color = <span class="number">-1</span>;<span class="comment">//-1表示未着色</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> tmp1 = <span class="number">0</span>, tmp2 = <span class="number">-1</span>;<span class="comment">//需要着色的顶点序号和色号</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; tmp1 &gt;&gt; tmp2;</span><br><span class="line">		vertexes[tmp1].color = tmp2;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> vertexes;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//构造边的信息</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span>** <span class="title">getEdges</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ifstream read;</span><br><span class="line">	read.open(<span class="string">"graph1.txt"</span>);</span><br><span class="line">	<span class="keyword">bool</span>** edges = <span class="keyword">new</span> <span class="keyword">bool</span>*[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		edges[i] = <span class="keyword">new</span> <span class="keyword">bool</span>[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">			edges[i][j] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> tmp1 = <span class="number">0</span>, tmp2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		read &gt;&gt; tmp1 &gt;&gt; tmp2;</span><br><span class="line">		edges[tmp1][tmp2] = <span class="number">1</span>;</span><br><span class="line">		edges[tmp2][tmp1] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	read.close();</span><br><span class="line">	<span class="keyword">return</span> edges;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用贪心算法为图着色</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">colorGraph</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m,<span class="keyword">int</span> x,<span class="keyword">int</span> colornum)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//n为顶点个数，m为预着色的点的个数,x为边的条数，colornum为颜色数</span></span><br><span class="line">	vertex* vertexes = getVertexes(n,m);</span><br><span class="line">	<span class="keyword">bool</span>** edges = getEdges(n, x);</span><br><span class="line">	<span class="keyword">int</span> notcolor = n - m;<span class="comment">//未着色的点的个数</span></span><br><span class="line">	<span class="keyword">int</span> nowcol = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (notcolor)&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">			<span class="keyword">if</span> (vertexes[i].color == <span class="number">-1</span>)&#123;<span class="comment">// 当前顶点未着色</span></span><br><span class="line">				<span class="keyword">bool</span> flag = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">					<span class="keyword">if</span> (edges[i][j] &amp;&amp; vertexes[j].color == nowcol)&#123;</span><br><span class="line">						flag = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (flag) &#123; vertexes[i].color = nowcol; --notcolor; &#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++nowcol;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; nowcol &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">	printVertex(vertexes, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSudo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//connectSudo();</span></span><br><span class="line">	printSudoVertex(getVertexes(<span class="number">81</span>,<span class="number">9</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	colorGraph(<span class="number">8</span>,<span class="number">0</span>,<span class="number">17</span>,<span class="number">4</span>);</span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h4><h5 id="无预着色："><a href="#无预着色：" class="headerlink" title="无预着色："></a>无预着色：</h5><p><img src="//yoursite.com/2019/05/13/算法大作业笔记（一）/桌面\时光以南\算法导论\作业\图片\1.png" width="25%"><img src="//yoursite.com/2019/05/13/算法大作业笔记（一）/桌面\时光以南\算法导论\作业\图片\2.png" width="25%"></p>
<p>graph1.txt(8个点，0个预着色点，17条边，4个颜色)</p>
<p>graph2.txt(7个点，0个预着色，12条边，4个颜色)</p>
<p>graph3.txt(4个点，0个预着色，5条边，4个颜色)</p>
<p>graph4.txt(6个点，0个预着色，7条边，2个颜色)</p>
<font color="green">（以上数据测试无误，撒花~~~）</font>

<h5 id="预着色："><a href="#预着色：" class="headerlink" title="预着色："></a>预着色：</h5><p><img src="//yoursite.com/2019/05/13/算法大作业笔记（一）/桌面\时光以南\算法导论\作业\图片\3.png" width="15%"><img src="//yoursite.com/2019/05/13/算法大作业笔记（一）/桌面\时光以南\算法导论\作业\图片\4.png" width="25%"></p>
<p>graph5.txt(6个点，3个预着色，6条边，2个颜色)</p>
<p>color5.txt</p>
<p>graph6.txt(7个点，2个预着色，12条边，7个颜色)</p>
<p>color6.txt</p>
<p>哦豁，graph6出问题了，去debug吧 .-_-.   </p>
<p>嗯，还好，输入数据的问题，不是程序的问题，数据已修正。</p>
<font color="green">（以上数据测试无误，撒花~~~）</font>

<h4 id="Sudo"><a href="#Sudo" class="headerlink" title="Sudo"></a>Sudo</h4><p>需要先对connectSudo()做一些修改，edge[i][i]应该为false。</p>
<p>然后，现在，先去准备一些Sudo<font color="blue">(注意顶点下标和色号都是从0开始的噢！)</font></p>
<p><img src="//yoursite.com/2019/05/13/算法大作业笔记（一）/桌面\时光以南\算法导论\作业\图片\5.png" width="75%"></p>
<p>这里的测试大概会出问题了，因为贪心算法目光短浅<font color="red">（贪心算法不足以解决所有的数独问题，因为我们没有考虑到每一个位置可能填上的所有数字，而只是贪心地填上当前满足条件的数字，所以之后的其他空格就不一定有数可填了）</font>，准备好……</p>
<p>好了，果然，用了11种颜色。纪念一下我失败的代码，下一篇里该做修改了~_~</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">vertex</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> index,color;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSudoEdges</span><span class="params">(<span class="keyword">bool</span>** edges, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ofstream write;</span><br><span class="line">	write.open(<span class="string">"sudoConnection.txt"</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">			write &lt;&lt; edges[i][j] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		write &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	write.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSudoVertex</span><span class="params">(vertex* ver)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">9</span>; j++)</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt;setw(<span class="number">4</span>)&lt;&lt; ver[<span class="number">9</span> * i + j].color &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//构造数独的边</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span>** <span class="title">connectSudo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = <span class="number">81</span>;<span class="comment">//数独有81个顶点</span></span><br><span class="line">	<span class="keyword">bool</span>** edges = <span class="keyword">new</span> <span class="keyword">bool</span>*[<span class="number">81</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">81</span>; i++)</span><br><span class="line">		edges[i] = <span class="keyword">new</span> <span class="keyword">bool</span>[<span class="number">81</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">81</span>; i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">81</span>; j++)</span><br><span class="line">			edges[i][j] = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//同行同列相连</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">9</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> cur_index = i * <span class="number">9</span> + j;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = j+<span class="number">1</span>; k &lt; <span class="number">9</span>; k++)</span><br><span class="line">			&#123;</span><br><span class="line">				edges[cur_index][i * <span class="number">9</span> + k] = <span class="number">1</span>;<span class="comment">//行相连</span></span><br><span class="line">				edges[i * <span class="number">9</span> + k][cur_index] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = i+<span class="number">1</span>; k &lt; <span class="number">9</span>; k++)</span><br><span class="line">			&#123;</span><br><span class="line">				edges[cur_index][j + k * <span class="number">9</span>] = <span class="number">1</span>;<span class="comment">//列相连</span></span><br><span class="line">				edges[j + k * <span class="number">9</span>][cur_index] = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//同宫相连</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> cur_index = <span class="number">9</span> * i + <span class="number">3</span> * j + k;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> p = j+<span class="number">1</span>; p &lt; <span class="number">3</span>; p++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="comment">//同宫同列</span></span><br><span class="line">					edges[cur_index][<span class="number">9</span> * i + <span class="number">3</span> * p + k] = <span class="number">1</span>;</span><br><span class="line">					edges[<span class="number">9</span> * i + <span class="number">3</span> * p + k][cur_index] = <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> q = k+<span class="number">1</span>; q &lt; <span class="number">3</span>; q++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="comment">//同宫同行</span></span><br><span class="line">					edges[cur_index][<span class="number">9</span> * i + <span class="number">3</span> * j + q] = <span class="number">1</span>;</span><br><span class="line">					edges[cur_index][<span class="number">9</span> * i + <span class="number">3</span> * j + q] = <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	printSudoEdges(edges, <span class="number">81</span>);</span><br><span class="line">	<span class="keyword">return</span> edges;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printVertex</span><span class="params">(vertex* ver,<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; ver[i].index &lt;&lt; <span class="string">" "</span> &lt;&lt; ver[i].color &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造顶点信息,预着色</span></span><br><span class="line"><span class="function">vertex* <span class="title">getVertexes</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">const</span> <span class="keyword">char</span>* filename)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	vertex* vertexes = <span class="keyword">new</span> vertex[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">	&#123;<span class="comment">//n为顶点个数，m为已着色的顶点数</span></span><br><span class="line">		vertexes[i].index = i;</span><br><span class="line">		vertexes[i].color = <span class="number">-1</span>;<span class="comment">//-1表示未着色</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> tmp1 = <span class="number">0</span>, tmp2 = <span class="number">-1</span>;<span class="comment">//需要着色的顶点序号和色号</span></span><br><span class="line">	<span class="keyword">if</span> (m &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		ifstream read;</span><br><span class="line">		read.open(filename);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			read &gt;&gt; tmp1 &gt;&gt; tmp2;</span><br><span class="line">			vertexes[tmp1].color = tmp2;</span><br><span class="line">		&#125;</span><br><span class="line">		read.close();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> vertexes;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//构造边的信息</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span>** <span class="title">getEdges</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> x,<span class="keyword">const</span> <span class="keyword">char</span>* filename)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ifstream read;</span><br><span class="line">	read.open(filename);</span><br><span class="line">	<span class="keyword">bool</span>** edges = <span class="keyword">new</span> <span class="keyword">bool</span>*[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		edges[i] = <span class="keyword">new</span> <span class="keyword">bool</span>[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">			edges[i][j] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> tmp1 = <span class="number">0</span>, tmp2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		read &gt;&gt; tmp1 &gt;&gt; tmp2;</span><br><span class="line">		edges[tmp1][tmp2] = <span class="number">1</span>;</span><br><span class="line">		edges[tmp2][tmp1] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	read.close();</span><br><span class="line">	<span class="keyword">return</span> edges;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用贪心算法为图着色</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">colorGraph</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m,<span class="keyword">int</span> colornum, vertex* vertexes, <span class="keyword">bool</span>** edges)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> notcolor = n - m;<span class="comment">//未着色的点的个数</span></span><br><span class="line">	<span class="keyword">int</span> nowcol = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (notcolor)&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">			<span class="keyword">if</span> (vertexes[i].color == <span class="number">-1</span>)&#123;<span class="comment">// 当前顶点未着色</span></span><br><span class="line">				<span class="keyword">bool</span> flag = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">					<span class="keyword">if</span> (edges[i][j] &amp;&amp; vertexes[j].color == nowcol)&#123;</span><br><span class="line">						flag = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (flag) &#123; vertexes[i].color = nowcol; --notcolor; &#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		++nowcol;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (colornum &lt; nowcol)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed"</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; nowcol &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">	printVertex(vertexes, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSudo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//connectSudo();</span></span><br><span class="line">	<span class="comment">//printSudoVertex(getVertexes(81,30,"sudoColor1.txt"));</span></span><br><span class="line">	colorGraph(<span class="number">81</span>, <span class="number">30</span>, <span class="number">9</span>, getVertexes(<span class="number">81</span>, <span class="number">30</span>, <span class="string">"sudoColor1.txt"</span>), connectSudo());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testGraph</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> x, <span class="keyword">int</span> colornum, <span class="keyword">const</span> <span class="keyword">char</span>* colorfile, <span class="keyword">const</span> <span class="keyword">char</span>* graphfile)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//n为顶点个数，m为预着色的点的个数,x为边的条数，colornum为颜色数</span></span><br><span class="line">	vertex* vertexes = getVertexes(n, m, colorfile);</span><br><span class="line">	<span class="keyword">bool</span>** edges = getEdges(n, x, graphfile);</span><br><span class="line">	colorGraph(n,m,colornum,vertexes, edges);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//testGraph(7,2,12,7,"graph6.txt","color6.txt");</span></span><br><span class="line">	testSudo();</span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/12/数据库大作业笔记（六）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/12/数据库大作业笔记（六）/" class="post-title-link" itemprop="url">数据库大作业笔记（六）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2019-05-12 09:21:31 / 修改时间：09:21:32" itemprop="dateCreated datePublished" datetime="2019-05-12T09:21:31+08:00">2019-05-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="PHP调用mysql存储过程"><a href="#PHP调用mysql存储过程" class="headerlink" title="PHP调用mysql存储过程"></a>PHP调用mysql存储过程</h3><p>请忽略我在第五篇笔记里的胡言乱语，现在的存储过程正常啦 哈哈哈</p>
<h4 id="MySQL里的存储过程"><a href="#MySQL里的存储过程" class="headerlink" title="MySQL里的存储过程"></a>MySQL里的存储过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE DEFINER=`root`@`localhost` PROCEDURE `proc_update`(IN `newcatid` CHAR(2), IN `newprice` FLOAT)</span><br><span class="line">    DETERMINISTIC</span><br><span class="line">BEGIN</span><br><span class="line">IF(select count(*) from borrow,equipment,category</span><br><span class="line">where borrow.eqpid=equipment.eqpid and equipment.catid=category.catid and category.catid=newcatid group by category.catid</span><br><span class="line">)&lt;5</span><br><span class="line">THEN</span><br><span class="line">  UPDATE category set price=newprice where catid=newcatid;</span><br><span class="line">ELSE</span><br><span class="line">  UPDATE category set price=(newprice*0.9) where catid=newcatid;</span><br><span class="line">end if;</span><br><span class="line">select newcatid,newprice;</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>这是一个在更新时调用的存储过程，PHP里想调用存储过程，要改写控制器里的actionUpdate()函数：</p>
<p>Path: backend\controllers\CategoryController.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionUpdate</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $model = <span class="keyword">$this</span>-&gt;findModel($id);</span><br><span class="line">        <span class="keyword">if</span> ($model-&gt;load(Yii::$app-&gt;request-&gt;post())) &#123;</span><br><span class="line"></span><br><span class="line">            $command= Yii::$app-&gt;db</span><br><span class="line">                -&gt;createCommand(<span class="string">'call proc_update(:p0,:p1)'</span>)</span><br><span class="line">                -&gt;bindValues([<span class="string">":p0"</span> =&gt;$model-&gt;catid, <span class="string">":p1"</span> =&gt;$model-&gt;price]);</span><br><span class="line">            $res=$command-&gt;execute();</span><br><span class="line">            <span class="keyword">if</span>($res&gt;=<span class="number">0</span>)</span><br><span class="line">            &#123;             </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redirect([<span class="string">'view'</span>, <span class="string">'id'</span> =&gt; $model-&gt;catid]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(<span class="string">'update'</span>, [</span><br><span class="line">            <span class="string">'model'</span> =&gt; $model,</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>另外哈，createCommand()里的sql语句出问题的话，要学会解决呀~~比如去掉某一个空格，故意让这个句子出错，然后去看报错信息里的sql语句有什么问题，为什么在MySQL里不起作用。</p>
<h3 id="yii框架中的数据库访问对象"><a href="#yii框架中的数据库访问对象" class="headerlink" title="yii框架中的数据库访问对象"></a>yii框架中的数据库访问对象</h3><h4 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h4><p>首先要创建数据库连接，语法很好查到。因为数据库连接经常使用，所以在一开始就一应用组件的方式来配置它：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="string">'components'</span> =&gt; [</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="string">'db'</span> =&gt; [</span><br><span class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\db\Connection'</span>,</span><br><span class="line">            <span class="string">'dsn'</span> =&gt; <span class="string">'mysql:host=localhost;dbname=example'</span>,</span><br><span class="line">            <span class="string">'username'</span> =&gt; <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'password'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">            <span class="string">'charset'</span> =&gt; <span class="string">'utf8'</span>,</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>之后就可以通过语句 Yii::$app-&gt;db 来使用数据库连接了。如果应用需要访问多个数据库，可以配置多个DB应用组件。dsn属性用来指明它的数据源名称，不用的数据库有不同的dsn格式，随用随查。</p>
<h4 id="执行SQL语句"><a href="#执行SQL语句" class="headerlink" title="执行SQL语句"></a>执行SQL语句</h4><p>主要分三步：创建command，绑定参数（可选），调用SQL执行方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回多行. 每行都是列名和值的关联数组.</span></span><br><span class="line"><span class="comment">// 如果该查询没有结果则返回空数组</span></span><br><span class="line">$posts = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT * FROM post'</span>)-&gt;queryAll();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一行 (第一行)</span></span><br><span class="line"><span class="comment">// 如果该查询没有结果则返回 false</span></span><br><span class="line">$post = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT * FROM post WHERE id=1'</span>)-&gt;queryOne();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一列 (第一列)</span></span><br><span class="line"><span class="comment">// 如果该查询没有结果则返回空数组</span></span><br><span class="line">$titles = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT title FROM post'</span>)-&gt;queryColumn();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个标量值</span></span><br><span class="line"><span class="comment">// 如果该查询没有结果则返回 false</span></span><br><span class="line">$count = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT COUNT(*) FROM post'</span>)-&gt;queryScalar();</span><br></pre></td></tr></table></figure>
<p>所有从数据库取得的数据都被表现为字符串。使用绑定参数的方法可以防止 SQL 注入攻击。在 SQL 语句中，可以嵌入一个或多个参数占位符。 一个参数占位符是以冒号开头的字符串。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$post = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT * FROM post WHERE id=:id AND status=:status'</span>)</span><br><span class="line">           -&gt;bindValue(<span class="string">':id'</span>, $_GET[<span class="string">'id'</span>])</span><br><span class="line">           -&gt;bindValue(<span class="string">':status'</span>, <span class="number">1</span>)</span><br><span class="line">           -&gt;queryOne();</span><br><span class="line"></span><br><span class="line"><span class="comment">#或使用：</span></span><br><span class="line"></span><br><span class="line">$params = [<span class="string">':id'</span> =&gt; $_GET[<span class="string">'id'</span>], <span class="string">':status'</span> =&gt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">$post = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT * FROM post WHERE id=:id AND status=:status'</span>)</span><br><span class="line">           -&gt;bindValues($params)</span><br><span class="line">           -&gt;queryOne();</span><br><span class="line">           </span><br><span class="line">$post = Yii::$app-&gt;db-&gt;createCommand(<span class="string">'SELECT * FROM post WHERE id=:id AND status=:status'</span>, $params)</span><br><span class="line">           -&gt;queryOne();</span><br></pre></td></tr></table></figure>
<p>bindValue()：绑定一个参数值<br>bindValues()：在一次调用中绑定多个参数值</p>
<p>可以使用不同参数多次执行。</p>
<p>执行非查询语句，即不取回数据的语句，调用excute()方法，返回执行 SQL 所影响到的行数。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Yii::$app-&gt;db-&gt;createCommand(<span class="string">'UPDATE post SET status=1 WHERE id=1'</span>)</span><br><span class="line">   -&gt;execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">// INSERT (table name, column values)</span></span><br><span class="line">Yii::$app-&gt;db-&gt;createCommand()-&gt;insert(<span class="string">'user'</span>, [</span><br><span class="line">    <span class="string">'name'</span> =&gt; <span class="string">'Sam'</span>,</span><br><span class="line">    <span class="string">'age'</span> =&gt; <span class="number">30</span>,</span><br><span class="line">])-&gt;execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">// UPDATE (table name, column values, condition)</span></span><br><span class="line">Yii::$app-&gt;db-&gt;createCommand()-&gt;update(<span class="string">'user'</span>, [<span class="string">'status'</span> =&gt; <span class="number">1</span>], <span class="string">'age &gt; 30'</span>)-&gt;execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">// DELETE (table name, condition)</span></span><br><span class="line">Yii::$app-&gt;db-&gt;createCommand()-&gt;delete(<span class="string">'user'</span>, <span class="string">'status = 0'</span>)-&gt;execute();</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/12/dramatic-lines/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/12/dramatic-lines/" class="post-title-link" itemprop="url">dramatic lines</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-12 08:26:41" itemprop="dateCreated datePublished" datetime="2019-05-12T08:26:41+08:00">2019-05-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-05-25 08:45:15" itemprop="dateModified" datetime="2019-05-25T08:45:15+08:00">2019-05-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><em>今日不属于六级内容，是为了英语课的任务而学习的话剧台词</em></p>
<h4 id="Narrator-D"><a href="#Narrator-D" class="headerlink" title="Narrator D:"></a>Narrator D:</h4><p>Yes, in a sense, he kills her by rejecting her love. Aphrodite, the goddess of love, heard her crying for her unrequited love and was kind to her, for Echo had been a true lover. Quietly and painlessly, Echo pined away and died. But her voice live on, lingering among the rocks and answering faintly whenever Narcissus or another called.</p>
<p>Yes, that’s Echo, and that’s how she is always remembered. The fate of Narcissus was now in the hands of Aphrodite.</p>
<p>I’m afraid so.</p>
<p>No, he just sits by its side day after day, looking at the only face in the world he loved but could not win. He pined away just as Echo did. Slowly Narcissus faded away, and at last his heart broke.</p>
<p>A white circle of petals round a yellow center.</p>
<h4 id="notes"><a href="#notes" class="headerlink" title="notes"></a>notes</h4><p>Narrator [ˈnæreɪtər] n. 旁白</p>
<p>Aphrodite [ˌæfrəˈdaɪti] n. 阿芙罗狄蒂（爱与美的女神）</p>
<p>unrequited [ˌʌnrɪˈkwaɪtɪd] adj. 没有回报的；单方面的；单相思的</p>
<p>pine away [paɪn əˈweɪ] 消瘦，憔悴</p>
<p>linger [ˈlɪŋɡər] v. 继续保存；流连；徘徊；磨蹭；持续看（或思考）</p>
<p>faintly [‘feɪntli] adv.淡淡；隐约地；有气无力地；昏</p>
<p>Narcissus [nɑːrˈsɪsəs] n. 水仙花；那喀索斯</p>
<hr>
<p>birdie [ˈbɜːrdi] n. 小鸟</p>
<p>nymph [nɪmf] n. 仙女;若虫</p>
<p>Epilogue [ˈepɪlɔːɡ] n. 终章;</p>
<p><strong>Scene II</strong></p>
<p><strong>Narrator C</strong>: (<strong>Looking anxiously at their back</strong>) Oh, does he kill her?</p>
<p><strong>Narrator D</strong>: Yes, in a sense. He kills her by rejecting her love.</p>
<p><strong>Narrator C</strong>: So Echo dies?</p>
<p><strong>Narrator D</strong>: Aphrodite, the goddess of love, heard her crying for her unrequited love and was kind to her, for Echo had been a true lover. Quietly and painlessly, Echo pined away and died. But her voice lived on, lingering among the rocks and answering faintly whenever Narcissus or another called.</p>
<p><strong>Narrator C</strong>: So when we hear an echo in the mountains or in caves, that’s Echo’s voice.</p>
<p><strong>Narrator D</strong>: Yes, that’s Echo, and that’s how she is always remembered.</p>
<p><strong>Narrator C</strong>: And Narcissus? Was he ever punished for his rude behavior?</p>
<p><strong>Narrator D</strong>: The fate of Narcissus was now in the hands of Aphrodite!</p>
<p><strong>Scene I</strong></p>
<p><strong>Narrator C</strong>: He’s gone off the deep end, hasn’t he?</p>
<p><strong>Narrator D</strong>: I’m afraid so.</p>
<p><strong>Narrator C</strong>: Does he ever leave the pool?</p>
<p><strong>Narrator D</strong>: No, he just sits by its side day after day, looking at the only face in the world he loved but could not win. He pined away just as Echo did. Slowly Narcissus faded away, and at last his heart broke.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/10/数据库大作业笔记（五）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/10/数据库大作业笔记（五）/" class="post-title-link" itemprop="url">数据库大作业笔记（五）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-10 19:11:59" itemprop="dateCreated datePublished" datetime="2019-05-10T19:11:59+08:00">2019-05-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-05-11 15:41:02" itemprop="dateModified" datetime="2019-05-11T15:41:02+08:00">2019-05-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>想给自己鼓个掌嘻嘻嘻~~我好像终于开始学会看错误信息了，最起码，看到满眼的红色错误不是畏惧而是开始找原因了~</p>
<h4 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h4><p>我在上一篇笔记中已经写好了mySql中的存储过程，并且现在在mySql中调用该存储过程也没有问题了，现在，我想要通过PHP调用该存储过程。主要是参数的设定不太好处理，需要从表单拿数据，在提交修改的表单之后，会得到：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$_GET = [</span><br><span class="line">    <span class="string">'r'</span> =&gt; <span class="string">'category/update'</span>,</span><br><span class="line">    <span class="string">'id'</span> =&gt; <span class="string">'c1'</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$_POST = [</span><br><span class="line">    <span class="string">'_csrf-backend'</span> =&gt; <span class="string">'9ueFt7KZe6r4VcicSw6wY4APsVfqiA8RtZwzfESZSQGFn7XExdozxr8ku9F6PeUk5HaCYKjMS3WB9lcjENIfUw=='</span>,</span><br><span class="line">    <span class="string">'Category'</span> =&gt; [</span><br><span class="line">        <span class="string">'catid'</span> =&gt; <span class="string">'c1'</span>,</span><br><span class="line">        <span class="string">'catname'</span> =&gt; <span class="string">'篮球'</span>,</span><br><span class="line">        <span class="string">'price'</span> =&gt; <span class="string">'99'</span>,</span><br><span class="line">    ],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$_COOKIE = [</span><br><span class="line">    <span class="string">'advanced-backend'</span> =&gt; <span class="string">'pgnho9lendv91620mh8550ev5p'</span>,</span><br><span class="line">    <span class="string">'_identity-backend'</span> =&gt; <span class="string">'c8280c8419576224c687b72352e3857f7a00c329ecb950cd464196e40ab17045a:2:&#123;i:0;s:17:"_identity-backend";i:1;s:46:"[2,"duWP0ncSYE-Rp1HhKBb8ncPdZULCl7yd",2592000]";&#125;'</span>,</span><br><span class="line">    <span class="string">'_csrf-backend'</span> =&gt; <span class="string">'6e9b91d151f1e7590262068eb1f645cd9440d436961faaefed7c4e0996111199a:2:&#123;i:0;s:13:"_csrf-backend";i:1;s:32:"sx0swCHlGqsM13UGdy37BDDd4jd_TKVR";&#125;'</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$_SESSION = [</span><br><span class="line">    <span class="string">'__flash'</span> =&gt; [],</span><br><span class="line">    <span class="string">'__returnUrl'</span> =&gt; <span class="string">'/yii2/sport_equipment/backend/web/'</span>,</span><br><span class="line">    <span class="string">'__id'</span> =&gt; <span class="number">2</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>然后PHP代码中经过判断，调用update()函数，在这里，想要获取catid和price，使用如下语句：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$Category  = $_POST[<span class="string">'Category'</span>];</span><br><span class="line">$tmpcatid=$Category[<span class="string">'catid'</span>];</span><br><span class="line">$price=$Category[<span class="string">'price'</span>];</span><br><span class="line">var_dump($catname,$price); <span class="comment">#查看结果</span></span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>从得到的结果中看出，我们已经成功获取参数啦~</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(2) "c1" string(3) "120"</span><br></pre></td></tr></table></figure>
<p>然后就方便了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$db = Yii::$app-&gt;db;</span><br><span class="line">$db-&gt;createCommand(<span class="string">"set @p0=$catid,@p0=$price"</span>)-&gt;execute();</span><br><span class="line">$db-&gt;createCommand(<span class="string">"call pro_update(@p0,@p1)"</span>)-&gt;execute();</span><br></pre></td></tr></table></figure>
<p>好吧，问题又来了——catid现在的值是c1，但实际上我应该给@p0的是‘c1’，报错信息：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c1' in 'field list'</span><br><span class="line">The SQL being executed was: set @p0=c1,@p0=99</span><br><span class="line">Error Info: Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; 42S22</span><br><span class="line">    [1] =&gt; 1054</span><br><span class="line">    [2] =&gt; Unknown column 'c1' in 'field list'</span><br><span class="line">)</span><br><span class="line">↵</span><br><span class="line">Caused by: PDOException</span><br><span class="line">SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c1' in 'field list'</span><br></pre></td></tr></table></figure>
<p>所以大概是要用到php的字符串连接了</p>
<p>语法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$s1=<span class="string">'i'</span>;</span><br><span class="line">$s2=<span class="string">' love '</span>;</span><br><span class="line">$s3=<span class="string">'u'</span>;</span><br><span class="line">$s4=$s1.$s2.$s3.$s4;</span><br><span class="line"></span><br><span class="line">$catid=<span class="string">"'"</span>.$tmpcatid.<span class="string">"'"</span>;</span><br></pre></td></tr></table></figure>
<p>最后的问题在于，我发现这句话没有起作用哇…这可如何是好，留到明天解决吧…至少这个command在MySQL里的执行是没有问题的了，大概是要换一种PHP的写法哦（Path:common\models\Category.php）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$db-&gt;createCommand(<span class="string">"SET @p0=$catid; SET @p1=$price; CALL `proc_update`(@p0, @p1);"</span>)-&gt;execute();</span><br></pre></td></tr></table></figure>
<hr>
<p>试了另外一种方法，还是不行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$Category  = $_POST[<span class="string">'Category'</span>];</span><br><span class="line">$tmpcatid=$Category[<span class="string">'catid'</span>];</span><br><span class="line">$price=$Category[<span class="string">'price'</span>];</span><br><span class="line"></span><br><span class="line">$catid=<span class="string">"'"</span>.$tmpcatid.<span class="string">"'"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// $conn = mysqli_connect('localhost','root','') or die("MYSQL_connect:".mysql_errno());</span></span><br><span class="line"><span class="comment">// $query = "SET @p0=$catid; SET @p1=$price; CALL `proc_update`(@p0, @p1);";</span></span><br><span class="line"><span class="comment">// $query_e = explode(';','$query');</span></span><br><span class="line"><span class="comment">// foreach ($query_e as $k =&gt;$v)</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">// mysqli_query($conn,$query_e[$k]);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// $db = Yii::$app-&gt;db;</span></span><br><span class="line"><span class="comment">// $db-&gt;createCommand("SET @p0=$catid; SET @p1=$price; CALL `proc_update`(@p0, @p1);")-&gt;execute();</span></span><br></pre></td></tr></table></figure>
<p>未解….</p>
<p>作为补偿，在这里记一下PHP中单引号和双引号的区别：</p>
<p><a href="https://www.cnblogs.com/peteremperor/p/6375085.html" target="_blank" rel="noopener">PHP中单引号和双引号的区别</a></p>
<p>在PHP中，字符串的定义可以使用英文单引号’ ‘，也可以使用英文双引号” “。一般情况下两者通用的。但双引号内部变量会解析,单引号则不解析。双引号中的变量($var)和特殊字符(\r\n之类)会被转义。单引号中的内容不会被转义，总被认为是普通字符，因此效率更高。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str=<span class="string">'hello'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"str is $str"</span>; <span class="comment">//运行结果: str is hello</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'str is $str'</span>; <span class="comment">//运行结果: str is str</span></span><br></pre></td></tr></table></figure>
<p>看颜色也就能看出区别吧。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/10/Yii框架的那些坑（二）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/10/Yii框架的那些坑（二）/" class="post-title-link" itemprop="url">数据库大作业笔记（四）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2019-05-10 16:04:49 / 修改时间：17:19:48" itemprop="dateCreated datePublished" datetime="2019-05-10T16:04:49+08:00">2019-05-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在写今天的正经内容之前，我真的是要吐槽一下我的英语水平（也有可能是打字水平）！！！Yii报错：</p>
<p><strong>Getting unknown property: common\models\Vborrow::browid</strong></p>
<p>吓得我从vborrow, vborrowSearch, vborrowController, vborrow/index找了半天，原来是拼写错误！！”borw”不是”brow”！我觉得这个错误和sxr同学的”model”—“module”有异曲同工之妙……</p>
<h4 id="mySql的存储过程"><a href="#mySql的存储过程" class="headerlink" title="mySql的存储过程"></a>mySql的存储过程</h4><h5 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h5><p>事先用“DELIMITER $$”或“DELIMITER //”声明当前段分隔符，让编译器把两个”//“之间的内容当做存储过程的代码，不会执行这些代码；“DELIMITER ;”的意为把分隔符还原。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$　　#将语句的结束符号从分号;临时改为两个$$(可以是自定义)</span><br><span class="line">CREATE PROCEDURE delete_matches(IN p_playerno INTEGER) #声明存储过程</span><br><span class="line">BEGIN</span><br><span class="line">SET @p_in=1; #变量赋值  </span><br><span class="line">DECLARE l_int int unsigned default 4000000; #变量定义</span><br><span class="line">DELETE FROM MATCHES WHERE playerno = p_playerno;</span><br><span class="line">END$$ #存储过程开始和结束符号</span><br><span class="line">elimiter; #将语句的结束符号恢复为分号</span><br><span class="line"></span><br><span class="line">call sp_name[(传参)];#调用存储过程</span><br></pre></td></tr></table></figure>
<p>然后问题就来了，我在mySql里写的存储过程，是要更新某一个值，没有语法错误，成功执行了，但是结果显示影响了0行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @p0=&apos;c1&apos;,@p1=&apos;120&apos; call proc_update(@p0,@p1)</span><br></pre></td></tr></table></figure>
<p>错误的代码大概会在我交完作业之后放上来。大概的函数体是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">begin</span><br><span class="line">if(/*condition*/)</span><br><span class="line">then</span><br><span class="line">update -- statement1</span><br><span class="line">else</span><br><span class="line">update -- statement2</span><br><span class="line">end if;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>经过测试，这么写的话，不管是什么condition，两个statement都没有执行。</p>
<hr>
<p>上面都是废话。直接写解决方法吧——</p>
<p><strong>存储过程中要有打印</strong>，比如在end if后面加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select @p0,@p1</span><br><span class="line">#select 1 都可以</span><br></pre></td></tr></table></figure>
<p><strong>参数名</strong>要改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@p0,@p1</span><br><span class="line">#而不能是</span><br><span class="line">@catid,@price</span><br></pre></td></tr></table></figure>
<p>不知道为什么，试了很久，这样改的时候就正常工作了。</p>
<h5 id="另外补充，MySQL中的注释有三种："><a href="#另外补充，MySQL中的注释有三种：" class="headerlink" title="另外补充，MySQL中的注释有三种："></a>另外补充，MySQL中的注释有三种：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 一般用于单行注释（注意 -- 后面要有空格！）</span><br><span class="line">/*Information ，一般用于多行注释 */ </span><br><span class="line">#Information</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/10/2018_06CET6_3_Translation/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/10/2018_06CET6_3_Translation/" class="post-title-link" itemprop="url">2018_06CET6_3_Translation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-10 08:53:37" itemprop="dateCreated datePublished" datetime="2019-05-10T08:53:37+08:00">2019-05-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="Translation-30-minutes"><a href="#Translation-30-minutes" class="headerlink" title="Translation (30 minutes)"></a>Translation (30 minutes)</h4><p>自行车曾经是中国城乡最主要的交通工具，中国一度被称为“自行车王国”。如今，随着城市交通拥堵和空气污染日益严重，骑自行车又开始流行起来。近来，中国企业家将移动互联网 技术与传统自行车结合在一起，发明了一种称为共享单车（shared bikes）的商业模式。共享单车的出现使骑车出行更加方便，人们仅需一部手机就可以随时使用共享单车。为了鼓励人们骑车出行，很多城市修建了自行车道。现在，越来越多的中国人也喜欢通过骑车健身。</p>
<p>Bicycles used to be <font color="red"> the leading means of transportation</font> in  <font color="#00ffff">  China’s cities and villages </font>, and China was <font color="Brown">once called</font> <font color="#FF8C00">“the Kingdom of Bicycles”</font>. Nowadays, with <font color="#8FBC8F">traffic congestion and air pollution</font> becoming more and more serious in cities, riding a bicycle is becoming popular again. Recently, China’s <font color="#ADFF2F">entrepreneurs</font> have <font color="#FF1493">combined mobile Internet technologies with bicycles</font>combined mobile Internet technologies with bicycles and invented the <font color="#FFD700">business model of bike-sharing</font>business model of bike-sharing. <font color="#008000">The appearance of shared bikes</font> has made it more convenient for people to <font color="#000080">get around</font>, and people can ride bikes at any time only with the help of a mobile phone. To encourage people to travel by bike, many cities have built <font color="#87CEEB">bike lanes</font>. Now, more and more Chinese people like exercising by riding bikes.</p>
<h5 id="notes"><a href="#notes" class="headerlink" title="notes"></a>notes</h5><p>今天的笔记可能过于鲜艳，是因为我顺便熟悉了一下Markdown修改字体颜色、大小、格式的语法:</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;font 更改语法&gt;文字内容&lt;/font&gt;</span><br><span class="line">更改语法包括：</span><br><span class="line">color=#0099ff   更改字体颜色</span><br><span class="line">face="黑体"   更改字体</span><br><span class="line">size= 7     更改字体大小</span><br><span class="line"></span><br><span class="line">&lt;font face="微软雅黑"&gt;我是微软雅黑&lt;/font&gt;</span><br><span class="line">&lt;font face="STCAIYUN"&gt;我是华文彩云&lt;/font&gt;</span><br><span class="line">&lt;font color=#0099ff size=6 face="黑体"&gt;color=#0099ff size=72 face="黑体"&lt;/font&gt;</span><br><span class="line"></span><br><span class="line">效果如下：</span><br></pre></td></tr></table></figure>
<font face="微软雅黑">我是微软雅黑</font><br><font face="STCAIYUN">我是华文彩云</font><br><font color="#0099ff" size="6" face="黑体">color=#0099ff size=6 face=”黑体”</font>

<p><strong>以下是今天的英语内容</strong></p>
<p>经过我再次阅读范文，我觉得文中都是正常水平，没有需要特意学习的，背就是了 哈哈哈哈</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/09/数据库大作业笔记（三）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="Joyce">
      <meta itemprop="description" content="Growing Path">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joyce' Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/09/数据库大作业笔记（三）/" class="post-title-link" itemprop="url">数据库大作业笔记（三）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2019-05-09 11:24:04 / 修改时间：15:18:04" itemprop="dateCreated datePublished" datetime="2019-05-09T11:24:04+08:00">2019-05-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="数据库插入异常"><a href="#数据库插入异常" class="headerlink" title="数据库插入异常"></a>数据库插入异常</h5><p>mySql报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Column count doesn&apos;t match value count at row 1</span><br></pre></td></tr></table></figure>
<p>网上给出的原因一致是：数据的个数、类型不符，或者就是中英文符号混用了。折腾了很久，终于发现是触发器导致了异常！！！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER add_audit AFTER INSERT ON equipment</span><br><span class="line"> FOR EACH ROW BEGIN</span><br><span class="line">insert into audit_equipment VALUES(new.eqpid,user(),now(),1);</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<p>怎么回事呢——改了audit_equipment表的属性，但忘了改equipment中的触发器，实际上是插入audit_equipment表时失败了，但是报错时就会显示equipment的插入失败。</p>
<h4 id="在MySQL中CHECK约束是无效的"><a href="#在MySQL中CHECK约束是无效的" class="headerlink" title="在MySQL中CHECK约束是无效的"></a>在MySQL中CHECK约束是无效的</h4><p>可以把对日期的约束写在yii中，也可以用触发器代替；</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/25/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><span class="page-number current">26</span><a class="page-number" href="/page/27/">27</a><span class="space">&hellip;</span><a class="page-number" href="/page/31/">31</a><a class="extend next" rel="next" href="/page/27/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Joyce" src="/images/logo.jpg">
  <p class="site-author-name" itemprop="name">Joyce</p>
  <div class="site-description" itemprop="description">Growing Path</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">310</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Joycepy" title="GitHub → https://github.com/Joycepy" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/pichunying@gmail.com" title="E-Mail → pichunying@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://tiffanychou21.github.io/" title="https://tiffanychou21.github.io/" rel="noopener" target="_blank">ZCF</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://jybwob.tk/" title="http://jybwob.tk/" rel="noopener" target="_blank">JYB</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://flippedyue.github.io/" title="https://flippedyue.github.io/" rel="noopener" target="_blank">JY</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://jerrymousez.github.io/" title="https://jerrymousez.github.io/" rel="noopener" target="_blank">JZ</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Joyce</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
